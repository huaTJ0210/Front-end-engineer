<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../react/react.js"></script>
    <script src="../react/react-dom.js"></script>
    <script src="../react/browser.min.js"></script>

    <script type="text/babel">

      // function Clock(props) {
      //     return(
      //         <div>
      //             <h1>Hello,world!</h1>
      //             <h2>It is {this.props.date.toLocaleDateString()}</h2>
      //         </div>
      //     );
      // }


      // 组件拥有自身的状态
        class Clock extends React.Component{
            constructor(props){
                super(props);
                this.state = {
                    date: new Date()
                }
            }
            // 组件挂载
            componentDidMount(){
                this.timer = setInterval(
                    () => this.tick(),
                    1000
                );
            }
            // 组件卸载
            componentWillMount(){
                clearInterval(this.timer);
            }

            tick(){
                this.setState({
                    date : new Date()
                });
            }

            render(){
                return(
                    <div>
                        <h1>Hello,world!</h1>
                        <h2>It is{this.state.date.toLocaleString()}</h2>
                    </div>
                );
            }
        }

      ReactDOM.render(
          <Clock />,
          document.getElementById('root')
      );

        // 正确的使用状态
        // 1 直接给状态赋值不会重新渲染组件; 构造函数是唯一能初始化 this.state的地方
      // this.state.comment = 'hello';
        // 应该直接使用 this.setState({comment:'Hello'});


        // this.props和this.state可能是异步更新的，不能依靠它的值来计算下一个状态

      // 此代码无法更新计数器
        this.setState({
            counter:this.state.counter + this.props.increment
        });
        // this.setState() 接收一个函数而非对象
        this.setState((prevState, props)=>({
            counter: prevState.counter + props.increment
        }));

        // 状态更新合并


    </script>

</head>
<body>
<div id="root"></div>
</body>
</html>